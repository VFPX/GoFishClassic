*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="gofish_options.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="1" />

	*<PropValue>
		DataSource = .NULL.
		Height = 0
		Left = 0
		Name = "Dataenvironment"
		Top = 0
		Width = 0
	*</PropValue>

ENDDEFINE

DEFINE CLASS gf_options AS gf_baseform OF "..\lib\gofishui.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="pfSettings" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageColumns.containerColumnCheckBoxes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageColumns.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageColumns.cmdSelectAll" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageColumns.cmdClearAll" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.cboDockable" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Spinner1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Spinner2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Spinner3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Spinner4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.cmdZoomDefault" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Command1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Spinner5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Label9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Spinner6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.chkDesktop" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pagePreferences.Check9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.List1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.cmdOpenFolder" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.cmdDeleteConfigFiles" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.chk_CRMode" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.chk_CRLocal_Default" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.chk_CRLocal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.cmdSetFolder" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageAdvanced.Label10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageThor.Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageThor.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageThor.lblNoTHor" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageThor.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.optiongroupReplaceSafetyLevel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Image1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Check1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Check2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.Text2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageReplace.cmdOpenFolder" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageBackups.Check1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageBackups.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageBackups.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageBackups.Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageBackups.Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageBackups.Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.pageBackups.Command2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page1.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page1.Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page1.Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page1.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page1.Image1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page1.Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page2.Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page2.Spinner1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page2.Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page2.Spinner2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="pfSettings.Page2.Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdOK" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Gf_versionlabel1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: applycolumnsettings
		*m: buildcolumncheckboxes
		*m: loadoptions
		*m: loadresultsformproperties
		*m: saveoptions
		*m: set_localfolder		&& cCR_StoreLocal_Option activated Check folder
		*m: validate
		*p: ccr_storelocal_option		&& Internal storage for new local path, just to display and set.
		*p: ccr_storelocal_set		&& Internal storage for local path, just storage.
		*p: dlastjanitorrundate
		*p: lcr_local		&& Use local storage place.
		*p: lcr_local_default		&& Local storage will be created on standard place by default.
		*p: ldesktop		&& The setting for Desktop.
		*p: lmovenewcodetotopleft
		*p: lrestoreprevioussearchresultsonstartup
		*p: lreturn
		*p: lsavesearchresults
		*p: lwarnwholeword
		*p: ndockable
		*p: njanitorreplacehistorydays
		*p: njanitorsearchhistorydays
		*p: nreplacerisk
		*p: ntabstospaces
		*p: ntreeviewfontsize
		*p: ooptions		&& A reference to the oSearchOptions object on GF main form.
	*</DefinedPropArrayMethod>

	*<PropValue>
		AlwaysOnTop = .T.
		BindControls = .F.
		BorderStyle = 3
		Caption = "GoFish Options"
		ccr_storelocal_option = 
		cuisettingsfile = GF_Options_Form_Settings.xml
		dlastjanitorrundate =   /  /  
		DoCreate = .T.
		Height = 600
		KeyPreview = .T.
		Left = 0
		lrestoreprevioussearchresultsonstartup = .F.
		lreturn = .F.
		lsavesearchresults = .T.
		lwarnwholeword = .F.
		MinHeight = 600
		MinWidth = 650
		Name = "GF_Options"
		ndockable = 0
		njanitorreplacehistorydays = 0
		njanitorsearchhistorydays = 0
		nreplacerisk = 0
		ntabstospaces = 0
		ntreeviewfontsize = 8
		oform = .NULL.
		ooptions = .NULL.
		Top = 0
		Visible = .T.
		Width = 652
		WindowType = 1
		_memberdata = <VFPData>
			<memberdata name="buildcolumncheckboxes" display="BuildColumnCheckBoxes"/>
			<memberdata name="oform" display="oForm"/>
			<memberdata name="applycolumnsettings" display="ApplyColumnSettings"/>
			<memberdata name="loadformsettings" display="LoadFormSettings"/>
			<memberdata name="cuisettingsfile" display="cUISettingsFile"/>
			<memberdata name="saveformsettings" display="SaveFormSettings"/>
			<memberdata name="ooptions" display="oOptions"/>
			<memberdata name="name" display="Name"/>
			<memberdata name="loadresultsformproperties" display="LoadResultsFormProperties"/>
			<memberdata name="lreturn" display="lReturn"/>
			<memberdata name="saveresultsformproperties" display="SaveResultsFormProperties"/>
			<memberdata name="saveoptions" display="SaveOptions"/>
			<memberdata name="loadoptions" display="LoadOptions"/>
			<memberdata name="validate" display="Validate"/>
			<memberdata name="ndockable" display="nDockable"/>
			<memberdata name="nreplacerisk" display="nReplaceRisk"/>
			<memberdata name="lwarnwholeword" display="lWarnWholeWord"/>
			<memberdata name="lrestoreprevioussearchresultsonstartup" display="lRestorePreviousSearchResultsOnStartup"/>
			<memberdata name="lsavesearchresults" display="lSaveSearchResults"/>
			<memberdata name="ntreeviewfontsize" display="nTreeViewFontSize"/>
			<memberdata name="njanitorsearchhistorydays" display="nJanitorSearchHistoryDays"/>
			<memberdata name="njanitorreplacehistorydays" display="nJanitorReplaceHistoryDays"/>
			<memberdata name="dlastjanitorrundate" display="dLastJanitorRunDate"/>
			<memberdata name="ntabstospaces" display="nTabsToSpaces"/>
			<memberdata name="set_localfolder" type="method" display="Set_LocalFolder" favorites="False"/>
			<memberdata name="ccr_storelocal_option" type="property" display="cCR_StoreLocal_Option" favorites="False"/>
			<memberdata name="lcr_local" type="property" display="lCR_Local" favorites="False"/>
			<memberdata name="lmovenewcodetotopleft" type="property" display="lMoveNewCodeToTopLeft" favorites="False"/>
			<memberdata name="ldesktop" type="property" display="lDesktop" favorites="False"/>
			<memberdata name="ccr_storelocal_set" type="property" display="cCR_StoreLocal_Set"/>
		</VFPData>
	*</PropValue>

	ADD OBJECT 'cmdCancel' AS commandbutton WITH ;
		Anchor = 12, ;
		Caption = "Cancel", ;
		Height = 21, ;
		Left = 573, ;
		Name = "cmdCancel", ;
		Top = 576, ;
		Width = 70
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdOK' AS commandbutton WITH ;
		Anchor = 12, ;
		Caption = "OK", ;
		Height = 21, ;
		Left = 496, ;
		Name = "cmdOK", ;
		Top = 576, ;
		Width = 70
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Gf_versionlabel1' AS gf_versionlabel WITH ;
		Left = 415, ;
		Name = "Gf_versionlabel1", ;
		Top = 1
		*< END OBJECT: ClassLib="..\lib\gofishui.vcx" BaseClass="label" />

	ADD OBJECT 'pfSettings' AS pageframe WITH ;
		ActivePage = 1, ;
		Anchor = 15, ;
		ErasePage = .T., ;
		Height = 528, ;
		Left = 10, ;
		Name = "pfSettings", ;
		PageCount = 8, ;
		TabStretch = 0, ;
		TabStyle = 1, ;
		Top = 18, ;
		Width = 638, ;
		Page1.Caption = "Column Selection", ;
		Page1.Name = "pageColumns", ;
		Page1.PageOrder = 2, ;
		Page2.Caption = "Preferences", ;
		Page2.Name = "pagePreferences", ;
		Page2.PageOrder = 1, ;
		Page3.Caption = "Advanced", ;
		Page3.Name = "pageAdvanced", ;
		Page3.PageOrder = 3, ;
		Page4.Caption = "Thor", ;
		Page4.Name = "pageThor", ;
		Page4.PageOrder = 6, ;
		Page5.Caption = "Replace", ;
		Page5.Name = "pageReplace", ;
		Page5.PageOrder = 4, ;
		Page6.Caption = "Backups", ;
		Page6.Name = "pageBackups", ;
		Page6.PageOrder = 5, ;
		Page7.Caption = "Update", ;
		Page7.Name = "Page1", ;
		Page7.PageOrder = 7, ;
		Page8.Caption = "Janitor", ;
		Page8.Name = "Page2", ;
		Page8.PageOrder = 8
		*< END OBJECT: BaseClass="pageframe" />

	ADD OBJECT 'pfSettings.Page1.Image1' AS image WITH ;
		Height = 230, ;
		Left = 207, ;
		Name = "Image1", ;
		Picture = ..\images\checkforupdates.jpg, ;
		Top = 120, ;
		Width = 232
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'pfSettings.Page1.Label1' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "If you are running the Thor Tool Management Framework, you can download and install the latest development builds of GoFish at any time, right from the Thor menu. (Requires Thor 1.10 or higher).", ;
		Height = 57, ;
		Left = 17, ;
		Name = "Label1", ;
		Top = 28, ;
		Width = 591, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.Page1.Label2' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "The latest development build may be a pre-release version, allowing you to use and test the latest version.", ;
		Height = 57, ;
		Left = 17, ;
		Name = "Label2", ;
		Top = 76, ;
		Width = 591, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.Page1.Label3' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Learn more about Thor", ;
		FontUnderline = .T., ;
		ForeColor = 0,0,255, ;
		Height = 17, ;
		Left = 17, ;
		MousePointer = 15, ;
		Name = "Label3", ;
		Top = 93, ;
		Width = 128
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.Page1.Label4' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Note: Public releases of GoFish are available at the VFPx site. However, the release cycle is generally slower on VFPx. If you want the absolute latest build, use the Thor update mechanism shown above.", ;
		Height = 56, ;
		Left = 20, ;
		Name = "Label4", ;
		Top = 385, ;
		Width = 555, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.Page1.Label5' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Visit the GoFish project on VFPx", ;
		FontUnderline = .T., ;
		ForeColor = 0,0,255, ;
		Height = 17, ;
		Left = 20, ;
		MousePointer = 15, ;
		Name = "Label5", ;
		Top = 422, ;
		Width = 175
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.Page2.Label1' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "# of days of Replace history to keep", ;
		Height = 17, ;
		Left = 105, ;
		Name = "Label1", ;
		TabIndex = 19, ;
		Top = 97, ;
		Width = 195
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.Page2.Label2' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "# of days of Search history to keep", ;
		Height = 17, ;
		Left = 105, ;
		Name = "Label2", ;
		TabIndex = 19, ;
		Top = 55, ;
		Width = 188
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.Page2.Label3' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "The janitor shows up once a day to clean up leftover files.", ;
		FontSize = 10, ;
		Height = 18, ;
		Left = 28, ;
		Name = "Label3", ;
		TabIndex = 19, ;
		Top = 20, ;
		Width = 332
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.Page2.Spinner1' AS spinner WITH ;
		ControlSource = "Thisform.nJanitorSearchHistoryDays", ;
		Height = 27, ;
		KeyboardHighValue = 999999, ;
		KeyboardLowValue = 0, ;
		Left = 27, ;
		Name = "Spinner1", ;
		SpinnerHighValue = 999999.00, ;
		SpinnerLowValue =   0.00, ;
		TabIndex = 10, ;
		Top = 50, ;
		Width = 69
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'pfSettings.Page2.Spinner2' AS spinner WITH ;
		ControlSource = "Thisform.nJanitorReplaceHistoryDays", ;
		Height = 27, ;
		KeyboardHighValue = 999999, ;
		KeyboardLowValue = 0, ;
		Left = 27, ;
		Name = "Spinner2", ;
		SpinnerHighValue = 999999.00, ;
		SpinnerLowValue =   0.00, ;
		TabIndex = 10, ;
		Top = 92, ;
		Width = 69
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'pfSettings.pageAdvanced.chk_CRLocal' AS checkbox WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = ("Local settings / storage"+0h0D0A+"All settings not in this box are local to resource file rather then in %App%, if activated."), ;
		ControlSource = "Thisform.lCR_Local", ;
		Height = 30, ;
		Left = 18, ;
		Name = "chk_CRLocal", ;
		TabIndex = 7, ;
		Top = 307, ;
		Visible = .F., ;
		Width = 466, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pageAdvanced.chk_CRLocal_Default' AS checkbox WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = [Use Set("Resource",1)+'\GoFish_" as default for new local folder], ;
		ControlSource = "Thisform.lCR_Local_Default", ;
		Height = 17, ;
		Left = 18, ;
		Name = "chk_CRLocal_Default", ;
		TabIndex = 7, ;
		Top = 291, ;
		Visible = .F., ;
		Width = 466, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pageAdvanced.chk_CRMode' AS checkbox WITH ;
		Alignment = 0, ;
		BackStyle = 0, ;
		Caption = "Allow CodeReferences-like work.", ;
		ControlSource = "Thisform.lCR_Allow", ;
		Left = 19, ;
		Name = "chk_CRMode", ;
		TabIndex = 7, ;
		Top = 271, ;
		Visible = .F., ;
		Width = 466, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pageAdvanced.cmdDeleteConfigFiles' AS commandbutton WITH ;
		Caption = "Delete config files!", ;
		Height = 19, ;
		Left = 23, ;
		Name = "cmdDeleteConfigFiles", ;
		TabIndex = 12, ;
		Top = 466, ;
		Width = 114
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pageAdvanced.cmdOpenFolder' AS commandbutton WITH ;
		Caption = "Open Folder", ;
		Height = 21, ;
		Left = 25, ;
		Name = "cmdOpenFolder", ;
		TabIndex = 10, ;
		Top = 435, ;
		Width = 80
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pageAdvanced.cmdSetFolder' AS commandbutton WITH ;
		Caption = "Set Folder", ;
		Height = 21, ;
		Left = 20, ;
		Name = "cmdSetFolder", ;
		TabIndex = 11, ;
		ToolTipText = "Pick a storage for lacal settings. Available after restart.", ;
		Top = 342, ;
		Visible = .F., ;
		Width = 80
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label1' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Configuration settings for GoFish are maintained in these XML files. See GoFish Help for more information.", ;
		Height = 32, ;
		Left = 255, ;
		Name = "Label1", ;
		TabIndex = 2, ;
		Top = 20, ;
		Width = 349, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label10' AS label WITH ;
		Anchor = 10, ;
		AutoSize = .T., ;
		Caption = "   Global Settings:   ", ;
		Height = 17, ;
		Left = 45, ;
		Name = "Label10", ;
		TabIndex = 8, ;
		Top = 251, ;
		Width = 107
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label2' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Axtive path to XML files:", ;
		Height = 25, ;
		Left = 12, ;
		Name = "Label2", ;
		TabIndex = 8, ;
		Top = 394, ;
		Width = 318, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label3' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Path to XML files will be shown here. See Init() method of this form", ;
		Height = 32, ;
		Left = 23, ;
		Name = "Label3", ;
		TabIndex = 9, ;
		Top = 415, ;
		Width = 596, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label4' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Double-Click to view or edit any file.", ;
		Height = 32, ;
		Left = 255, ;
		Name = "Label4", ;
		TabIndex = 5, ;
		Top = 137, ;
		Width = 349, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label5' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Close GoFish and delete any file to restore that portion of GoFish to the default state. A new XML file will be built automatically.", ;
		Height = 32, ;
		Left = 255, ;
		Name = "Label5", ;
		TabIndex = 6, ;
		Top = 176, ;
		Width = 349, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label6' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "The files are maintained automatically by GoFish to maintain settings between sessions.", ;
		Height = 32, ;
		Left = 255, ;
		Name = "Label6", ;
		TabIndex = 3, ;
		Top = 59, ;
		Width = 349, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label7' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "If you are curious you may view these files, or if you have special needs you may edit them.", ;
		Height = 32, ;
		Left = 255, ;
		Name = "Label7", ;
		TabIndex = 4, ;
		Top = 98, ;
		Width = 349, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label8' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "You can reset GoFish by deleting its config files. New config files will be built upon exit.", ;
		ForeColor = 255,0,0, ;
		Height = 32, ;
		Left = 142, ;
		Name = "Label8", ;
		TabIndex = 13, ;
		Top = 469, ;
		Width = 596, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.Label9' AS label WITH ;
		Alignment = 2, ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "********** Available after Restart of GoFish! Check or additional options after restart **********", ;
		FontBold = .T., ;
		ForeColor = 255,0,0, ;
		Left = 12, ;
		Name = "Label9", ;
		TabIndex = 13, ;
		Top = 368, ;
		Visible = .F., ;
		Width = 596, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageAdvanced.List1' AS listbox WITH ;
		Height = 227, ;
		Left = 12, ;
		Name = "List1", ;
		RowSourceType = 7, ;
		TabIndex = 1, ;
		Top = 17, ;
		Width = 236
		*< END OBJECT: BaseClass="listbox" />

	ADD OBJECT 'pfSettings.pageAdvanced.Shape1' AS shape WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Height = 131, ;
		Left = 11, ;
		Name = "Shape1", ;
		Top = 258, ;
		Width = 611
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'pfSettings.pageAdvanced.Text1' AS textbox WITH ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		ControlSource = "Thisform.cCR_StoreLocal_Option", ;
		Left = 111, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		Top = 342, ;
		Visible = .F., ;
		Width = 394
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pfSettings.pageBackups.Check1' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Backup source files when performing Replace operations.", ;
		ControlSource = "Thisform.oSearchOptions.lBackup", ;
		Height = 17, ;
		Left = 18, ;
		Name = "Check1", ;
		Top = 119, ;
		Width = 336
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pageBackups.Command2' AS commandbutton WITH ;
		Caption = "Open Folder", ;
		Height = 21, ;
		Left = 132, ;
		Name = "Command2", ;
		Top = 220, ;
		Width = 80
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pageBackups.Label1' AS label WITH ;
		BackStyle = 0, ;
		Caption = "GoFish can create backups of files on which you perform a Replace operation. The backup files are stored in the folder path Home(7) \ GoFishBackps \ <nnnn> \ <filename> where <nnnn> is the Replace History Id that is assigned to each replace operation.", ;
		Height = 45, ;
		Left = 18, ;
		Name = "Label1", ;
		Top = 18, ;
		Width = 600, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageBackups.Label2' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "See the GoFish Backup Help page for more info.", ;
		FontUnderline = .T., ;
		ForeColor = 0,0,255, ;
		Height = 17, ;
		Left = 51, ;
		MousePointer = 15, ;
		Name = "Label2", ;
		Top = 152, ;
		Width = 266
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageBackups.Label3' AS label WITH ;
		BackStyle = 0, ;
		Caption = "You can map the <nnnn> folder reference to the Replace History log to view complete details of each replace operation.", ;
		Height = 45, ;
		Left = 18, ;
		Name = "Label3", ;
		Top = 73, ;
		Width = 600, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageBackups.Label4' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Path to Backup files:", ;
		Height = 25, ;
		Left = 15, ;
		Name = "Label4", ;
		Top = 224, ;
		Width = 318, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageBackups.Label5' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Path to backup files will be shown here. See Init() method of this label.", ;
		Height = 32, ;
		Left = 26, ;
		Name = "Label5", ;
		Top = 248, ;
		Width = 596, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageColumns.cmdClearAll' AS commandbutton WITH ;
		Caption = "Clear All", ;
		FontSize = 8, ;
		Height = 26, ;
		Left = 21, ;
		Name = "cmdClearAll", ;
		Top = 98, ;
		Width = 58
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pageColumns.cmdSelectAll' AS commandbutton WITH ;
		Caption = "Select All", ;
		FontSize = 8, ;
		Height = 26, ;
		Left = 21, ;
		Name = "cmdSelectAll", ;
		Top = 56, ;
		Width = 58
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pageColumns.containerColumnCheckBoxes' AS container WITH ;
		Anchor = 5, ;
		Height = 431, ;
		Left = 14, ;
		Name = "containerColumnCheckBoxes", ;
		Top = 46, ;
		Width = 526
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'pfSettings.pageColumns.Label1' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "Choose which columns you want to appear in the search results grid.", ;
		FontBold = .T., ;
		Height = 28, ;
		Left = 15, ;
		Name = "Label1", ;
		Top = 14, ;
		Width = 470, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.cboDockable' AS combobox WITH ;
		BoundColumn = 2, ;
		BoundTo = .T., ;
		ColumnCount = 2, ;
		ColumnWidths = "300,0", ;
		ControlSource = "Thisform.nDockable", ;
		Height = 22, ;
		Left = 79, ;
		Name = "cboDockable", ;
		RowSource = "0 - Does not support docking,0,1 - Supports docking and is dockable,1,2 - Supports docking and is not dockable,2", ;
		RowSourceType = 1, ;
		Style = 2, ;
		TabIndex = 2, ;
		Top = 30, ;
		Width = 305
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check1' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Display dialog when files cannot be found or opened during a search or replace", ;
		ControlSource = "Thisform.oSearchOptions.lShowErrorMessages", ;
		Height = 17, ;
		Left = 27, ;
		Name = "Check1", ;
		TabIndex = 5, ;
		Top = 87, ;
		Width = 452
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check2' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Display each filename as it is processed (slows down search)", ;
		ControlSource = "Thisform.oSearchOptions.lShowWaitMessages", ;
		Height = 17, ;
		Left = 27, ;
		Name = "Check2", ;
		TabIndex = 7, ;
		Top = 133, ;
		Width = 359
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check3' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Display dialog box if no matches are found during a search.", ;
		ControlSource = "Thisform.oSearchOptions.lShowNoMatchesMessage", ;
		Height = 17, ;
		Left = 27, ;
		Name = "Check3", ;
		TabIndex = 6, ;
		Top = 110, ;
		Width = 342
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check4' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Show Advanced Search form on startup", ;
		ControlSource = "Thisform.oSearchOptions.lShowAdvancedFormOnStartup", ;
		Height = 17, ;
		Left = 28, ;
		Name = "Check4", ;
		TabIndex = 9, ;
		Top = 193, ;
		Width = 233
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check5' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Clear 'Apply Filter' checkbox with each new search", ;
		ControlSource = "Thisform.lClearApplyFilter", ;
		Height = 17, ;
		Left = 28, ;
		Name = "Check5", ;
		TabIndex = 10, ;
		Top = 216, ;
		Width = 290
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check6' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Always confirm use of Whole Word search?", ;
		ControlSource = "Thisform.lWarnWholeWord", ;
		Height = 17, ;
		Left = 27, ;
		Name = "Check6", ;
		TabIndex = 8, ;
		Top = 157, ;
		Width = 255
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check7' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Restore previous search results on startup", ;
		ControlSource = "Thisform.lRestorePreviousSearchResultsOnStartup", ;
		Height = 17, ;
		Left = 28, ;
		Name = "Check7", ;
		TabIndex = 13, ;
		Top = 263, ;
		Width = 252
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check8' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Save each search results to search history folder.", ;
		ControlSource = "Thisform.lSaveSearchResults", ;
		Height = 17, ;
		Left = 28, ;
		Name = "Check8", ;
		TabIndex = 11, ;
		Top = 239, ;
		Width = 287
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.Check9' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Open code windows at top left corner", ;
		ControlSource = "Thisform.lMoveNewCodeToTopLeft", ;
		Height = 17, ;
		Left = 28, ;
		Name = "Check9", ;
		TabIndex = 14, ;
		Top = 287, ;
		Width = 220
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.chkDesktop' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Desktop", ;
		ControlSource = "Thisform.lDesktop", ;
		Height = 17, ;
		Left = 401, ;
		Name = "chkDesktop", ;
		TabIndex = 3, ;
		Top = 33, ;
		Width = 64
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pagePreferences.cmdZoomDefault' AS commandbutton WITH ;
		Caption = "Default 1.0", ;
		FontSize = 8, ;
		Height = 22, ;
		Left = 308, ;
		Name = "cmdZoomDefault", ;
		TabIndex = 21, ;
		Top = 354, ;
		Width = 71
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pagePreferences.Command1' AS commandbutton WITH ;
		Caption = " Open Folder", ;
		Height = 25, ;
		Left = 337, ;
		Name = "Command1", ;
		Picture = ..\..\2015-10-25 beta jrn\images\browsefolder.bmp, ;
		PicturePosition = 1, ;
		SpecialEffect = 0, ;
		TabIndex = 12, ;
		ToolTipText = "Open Explorer window to this path.", ;
		Top = 235, ;
		Width = 118
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pagePreferences.Label1' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Dockable", ;
		Height = 17, ;
		Left = 21, ;
		Name = "Label1", ;
		TabIndex = 1, ;
		Top = 33, ;
		Width = 54
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Label2' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Grid font size", ;
		Height = 18, ;
		Left = 88, ;
		Name = "Label2", ;
		TabIndex = 17, ;
		Top = 326, ;
		Width = 103
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Label3' AS label WITH ;
		BackStyle = 0, ;
		Caption = "DisplayCount for Search/Scope history dropdowns", ;
		Height = 18, ;
		Left = 88, ;
		Name = "Label3", ;
		TabIndex = 25, ;
		Top = 388, ;
		Width = 311
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Label4' AS label WITH ;
		AutoSize = .T., ;
		BackColor = 255,255,255, ;
		BackStyle = 1, ;
		Caption = " Messages / Dialogs", ;
		Height = 17, ;
		Left = 33, ;
		Name = "Label4", ;
		TabIndex = 4, ;
		Top = 65, ;
		Width = 115
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Label5' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Maximum number of results to find", ;
		Height = 17, ;
		Left = 84, ;
		Name = "Label5", ;
		TabIndex = 29, ;
		ToolTipText = "Search will automatically stop once this number of mached lines it reached.", ;
		Top = 458, ;
		Width = 191
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Label6' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Number of items in each MRU list for Search/Scope dropdowns", ;
		Height = 18, ;
		Left = 88, ;
		Name = "Label6", ;
		TabIndex = 27, ;
		Top = 419, ;
		Width = 396
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Label7' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Code Browser zoom factor (0.7 - 2.00)", ;
		Height = 18, ;
		Left = 88, ;
		Name = "Label7", ;
		TabIndex = 22, ;
		Top = 357, ;
		Width = 217
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Label8' AS label WITH ;
		BackStyle = 0, ;
		Caption = "TreeView font size", ;
		Height = 18, ;
		Left = 290, ;
		Name = "Label8", ;
		TabIndex = 18, ;
		Top = 327, ;
		Width = 103
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Label9' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Tabs to spaces", ;
		Height = 18, ;
		Left = 482, ;
		Name = "Label9", ;
		TabIndex = 23, ;
		Top = 358, ;
		Width = 103
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pagePreferences.Shape1' AS shape WITH ;
		BackStyle = 0, ;
		Curvature = 3, ;
		Height = 111, ;
		Left = 17, ;
		Name = "Shape1", ;
		Top = 73, ;
		Width = 534
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'pfSettings.pagePreferences.Spinner1' AS spinner WITH ;
		ControlSource = "Thisform.nGridFontSize", ;
		Height = 27, ;
		KeyboardHighValue = 24, ;
		KeyboardLowValue = 6, ;
		Left = 23, ;
		Name = "Spinner1", ;
		SpinnerHighValue =  24.00, ;
		SpinnerLowValue =   6.00, ;
		TabIndex = 15, ;
		Top = 321, ;
		Width = 59
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'pfSettings.pagePreferences.Spinner2' AS spinner WITH ;
		ControlSource = "Thisform.nDropDownDisplayCount", ;
		Height = 27, ;
		KeyboardHighValue = 100, ;
		KeyboardLowValue = 5, ;
		Left = 23, ;
		Name = "Spinner2", ;
		SpinnerHighValue = 100.00, ;
		SpinnerLowValue =   5.00, ;
		TabIndex = 24, ;
		Top = 383, ;
		Width = 59
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'pfSettings.pagePreferences.Spinner3' AS spinner WITH ;
		ControlSource = "Thisform.nDropDownMaxMRU", ;
		Height = 27, ;
		KeyboardHighValue = 100, ;
		KeyboardLowValue = 1, ;
		Left = 23, ;
		Name = "Spinner3", ;
		SpinnerHighValue = 100.00, ;
		SpinnerLowValue =   1.00, ;
		TabIndex = 26, ;
		Top = 414, ;
		Width = 59
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'pfSettings.pagePreferences.Spinner4' AS spinner WITH ;
		ControlSource = "Thisform.nBrowserZoom", ;
		Height = 27, ;
		Increment =   0.10, ;
		InputMask = "9.99", ;
		KeyboardLowValue = 0, ;
		Left = 23, ;
		Name = "Spinner4", ;
		SpinnerHighValue =   2.00, ;
		SpinnerLowValue =   0.70, ;
		TabIndex = 19, ;
		Top = 352, ;
		Value = 0.1, ;
		Width = 59
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'pfSettings.pagePreferences.Spinner5' AS spinner WITH ;
		ControlSource = "Thisform.nTreeViewFontSize", ;
		Height = 27, ;
		KeyboardHighValue = 24, ;
		KeyboardLowValue = 6, ;
		Left = 225, ;
		Name = "Spinner5", ;
		SpinnerHighValue =  24.00, ;
		SpinnerLowValue =   6.00, ;
		TabIndex = 16, ;
		Top = 322, ;
		Width = 59
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'pfSettings.pagePreferences.Spinner6' AS spinner WITH ;
		ControlSource = "Thisform.nTabsToSpaces", ;
		Height = 27, ;
		KeyboardHighValue = 10, ;
		KeyboardLowValue = 0, ;
		Left = 417, ;
		Name = "Spinner6", ;
		SpinnerHighValue =  10.00, ;
		SpinnerLowValue =   0.00, ;
		TabIndex = 20, ;
		Top = 353, ;
		Width = 59
		*< END OBJECT: BaseClass="spinner" />

	ADD OBJECT 'pfSettings.pagePreferences.Text1' AS textbox WITH ;
		ControlSource = "Thisform.oSearchOptions.nMaxResults", ;
		Height = 25, ;
		InputMask = "9999999", ;
		Left = 22, ;
		Name = "Text1", ;
		TabIndex = 28, ;
		Top = 454, ;
		Width = 59
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pfSettings.pageReplace.Check1' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Enable Replace Mode", ;
		ControlSource = "Thisform.oSearchOptions.lEnableReplaceMode", ;
		Height = 17, ;
		Left = 10, ;
		Name = "Check1", ;
		Top = 5, ;
		Width = 139
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pageReplace.Check2' AS checkbox WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Do not show replace warning dialog box with each replace", ;
		ControlSource = "Thisform.oSearchOptions.lDoNotShowReplaceWarning", ;
		Height = 17, ;
		Left = 7, ;
		Name = "Check2", ;
		Top = 421, ;
		Width = 336
		*< END OBJECT: BaseClass="checkbox" />

	ADD OBJECT 'pfSettings.pageReplace.cmdOpenFolder' AS commandbutton WITH ;
		Anchor = 8, ;
		Caption = "Open Folder", ;
		Height = 21, ;
		Left = 550, ;
		Name = "cmdOpenFolder", ;
		Top = 421, ;
		Width = 80
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'pfSettings.pageReplace.Image1' AS image WITH ;
		Height = 296, ;
		Left = 4, ;
		Name = "Image1", ;
		Picture = ..\images\replacelevels.bmp, ;
		Stretch = 0, ;
		Top = 124, ;
		Width = 619
		*< END OBJECT: BaseClass="image" />

	ADD OBJECT 'pfSettings.pageReplace.Label1' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Warning: There are many risks associated with tools that replace code on your source files. Please review the GoFish Code Replacement Guide to be sure you understand how to use GoFish to replace code, and what the risks are.", ;
		ForeColor = 255,0,0, ;
		Height = 45, ;
		Left = 8, ;
		Name = "Label1", ;
		Top = 26, ;
		Width = 582, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageReplace.Label2' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "See the GoFish Replace Help page for more info.", ;
		FontUnderline = .T., ;
		ForeColor = 0,0,255, ;
		Height = 17, ;
		Left = 126, ;
		MousePointer = 15, ;
		Name = "Label2", ;
		Top = 56, ;
		Width = 271
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageReplace.Label3' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Select the maximum Replace Risk level to enable in the results grid:", ;
		FontBold = .T., ;
		Height = 17, ;
		Left = 10, ;
		Name = "Label3", ;
		Top = 79, ;
		Width = 385
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageReplace.Label4' AS label WITH ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Replace Detail Table:", ;
		Height = 19, ;
		Left = 6, ;
		Name = "Label4", ;
		Top = 446, ;
		Width = 121, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageReplace.Label5' AS label WITH ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Replace History Table:", ;
		Height = 19, ;
		Left = 6, ;
		Name = "Label5", ;
		Top = 473, ;
		Width = 126, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageReplace.optiongroupReplaceSafetyLevel' AS optiongroup WITH ;
		ButtonCount = 3, ;
		ControlSource = "Thisform.nReplaceRisk", ;
		Height = 25, ;
		Left = 121, ;
		Name = "optiongroupReplaceSafetyLevel", ;
		Top = 100, ;
		Value = 0, ;
		Width = 355, ;
		Option1.AutoSize = .T., ;
		Option1.BackStyle = 0, ;
		Option1.Caption = "1= Pretty Safe", ;
		Option1.Height = 17, ;
		Option1.Left = 8, ;
		Option1.Name = "Option2", ;
		Option1.Top = 4, ;
		Option1.Width = 93, ;
		Option2.AutoSize = .T., ;
		Option2.BackStyle = 0, ;
		Option2.Caption = "2 = Kinda Safe", ;
		Option2.Height = 17, ;
		Option2.Left = 121, ;
		Option2.Name = "Option3", ;
		Option2.Top = 4, ;
		Option2.Width = 98, ;
		Option3.AutoSize = .T., ;
		Option3.BackStyle = 0, ;
		Option3.Caption = "3 = Dangerous", ;
		Option3.Height = 17, ;
		Option3.Left = 246, ;
		Option3.Name = "Option4", ;
		Option3.Top = 4, ;
		Option3.Width = 100
		*< END OBJECT: BaseClass="optiongroup" />

	ADD OBJECT 'pfSettings.pageReplace.Text1' AS textbox WITH ;
		Anchor = 10, ;
		ControlSource = "Thisform.oSearchEngine.cReplaceDetailTable", ;
		Enabled = .F., ;
		Height = 25, ;
		Left = 132, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		TabIndex = 14, ;
		Top = 443, ;
		Width = 498
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pfSettings.pageReplace.Text2' AS textbox WITH ;
		Anchor = 10, ;
		ControlSource = "Thisform.oSearchEngine.cReplaceHistoryTable", ;
		Enabled = .F., ;
		Height = 25, ;
		Left = 132, ;
		Name = "Text2", ;
		ReadOnly = .T., ;
		TabIndex = 14, ;
		Top = 470, ;
		Width = 498
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'pfSettings.pageThor.Label1' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "GoFish will be automatically registered with Thor if it is present. This will provide a way to assign a hotkey to launch Gofish, as well as expose classes for advanced uses of GoFish.", ;
		Height = 32, ;
		Left = 38, ;
		Name = "Label1", ;
		Top = 25, ;
		Width = 555, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageThor.Label2' AS label WITH ;
		AutoSize = .T., ;
		BackStyle = 0, ;
		Caption = "Learn more about Thor", ;
		FontUnderline = .T., ;
		ForeColor = 0,0,255, ;
		Height = 17, ;
		Left = 412, ;
		MousePointer = 15, ;
		Name = "Label2", ;
		Top = 68, ;
		Width = 128
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageThor.Label4' AS label WITH ;
		Anchor = 10, ;
		BackStyle = 0, ;
		Caption = "You can learn more about Thor at the VFPX.CodePlex.com website.", ;
		Height = 32, ;
		Left = 38, ;
		Name = "Label4", ;
		Top = 68, ;
		Width = 398, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'pfSettings.pageThor.lblNoTHor' AS label WITH ;
		Alignment = 2, ;
		Anchor = 256, ;
		BackStyle = 0, ;
		Caption = "Thor is not presently running on your system.", ;
		ForeColor = 255,0,0, ;
		Height = 17, ;
		Left = 38, ;
		Name = "lblNoTHor", ;
		Top = 105, ;
		Visible = .F., ;
		Width = 245, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />
	
	PROCEDURE Activate
		Thisform.Refresh()
	ENDPROC

	PROCEDURE applycolumnsettings
		Local lcControlSourceField, loColumn, loControl
		
		*-- Set .Visible property on the Results form grid columns
		For each loControl in Thisform.pfSettings.pageColumns.containerColumnCheckBoxes.Controls
			lcControlSourceField = loControl.tag
			loColumn = Thisform.oForm.oGrid.FindColumn(lcControlSourceField)
			loColumn.Visible = Iif(loControl.value = 1, .t., .f.)
		EndFor 
	ENDPROC

	PROCEDURE buildcolumncheckboxes
		Local laFieldNames[1], lcName, llAlreadyAdded, lnContainerHeight, lnCount, lnRow, lnTop
		Local lnVerticalSpacing, lnX, lnY, loCheckBox, loColumn, loContainerCheckBoxes, loPageframe
		
		lnY	= 12
		lnX	= 90
		
		lnVerticalSpacing = 18
		llAlreadyAdded	  = .F.
		
		loPageframe			  = Thisform.pfSettings
		loContainerCheckBoxes = m.loPageframe.pageColumns.containerColumnCheckBoxes
		lnContainerHeight	  = m.loContainerCheckBoxes.Height
		
		Dimension m.laFieldNames[This.oForm.oGrid.ColumnCount, 4]
		
		For Each m.loColumn In This.oForm.oGrid.Columns FoxObject
			lnRow = m.loColumn.ColumnOrder
			laFieldNames[lnRow, 1]	= iif(m.loColumn.Visible, 'A' + Str(lnRow, 4, 0), 'B' + Upper(m.loColumn.Header1.Caption)) 
			laFieldNames[lnRow, 2]	= m.loColumn.Visible
			laFieldNames[lnRow, 3]	= m.loColumn.Header1.Caption
			laFieldNames[lnRow, 4]	= m.loColumn.Header1.Tag
		Endfor
		
		Asort(m.laFieldNames, 1, -1)
		
		lnTop = m.lnY
		
		For lnCount = 1 To Alen(m.laFieldNames, 1)
		
			lcName = 'CheckBox_' + Alltrim(Str(m.lnCount))
			Try
				m.loContainerCheckBoxes.RemoveObject(m.lcName)
			Catch
			Endtry
			m.loContainerCheckBoxes.AddObject(m.lcName, 'CheckBox')
			loCheckBox = m.loContainerCheckBoxes.&lcName
		
			With m.loCheckBox
				.Caption  = m.laFieldNames[m.lnCount, 3]
				.Tag	  = m.laFieldNames[m.lnCount, 4] && Holds the control source!!!
				.Value	  = Iif(m.laFieldNames[m.lnCount, 2] = .T., 1, 0)
				.Visible  = .T.
				.AutoSize = .T.
		
				If m.lnTop + m.lnVerticalSpacing > m.lnContainerHeight - 12
					lnTop = m.lnY
					lnX	  = m.lnX + 200
				Endif
		
				.Left	  = m.lnX
				.Top	  = m.lnTop
				.TabIndex = m.lnCount
				lnTop	  = m.lnTop + m.lnVerticalSpacing
			Endwith
		
		Endfor
		
		 
	ENDPROC

	PROCEDURE Destroy
		DoDefault()
		
		If this.lReturn = .t.
			ThisForm.SaveOptions()
		Endif
		
	ENDPROC

	PROCEDURE Init
		Lparameters toForm
		
		If VarType(m.toForm) != 'O'
			Messagebox('Must pass a reference to GoFish Results Form when calling this form.', 0, 'GoFish')
			Return .F.
		Endif
		
		This.MinHeight = This.Height
		This.MaxHeight = Int(This.Height * 1.5)
		This.MinWidth  = This.Width
		This.MaxWidth  = Int(This.Width * 1.5)
		
		DoDefault(m.toForm)
		
		Thisform.LoadOptions()
		
		This.BindControls = .T.
		
		Thisform.pfSettings.pageBackups.Enabled = Thisform.oSearchOptions.lEnableReplaceMode
		
		*SF 20221018 -> local storage
		If Thisform.oForm.nFirstLoad=1 Then
			This.pfSettings.pageAdvanced.Label3.Caption = 'Home(7)  =  ' + Proper(Addbs(Home(7)))
			This.pfSettings.pageBackups.Label5.Caption  = 'Home(7)\GoFishBackups\ =  ' + Proper(Addbs(Home(7)) + 'GoFishBackups\' )
		Else  &&thisform.oForm.nFirstLoad=1
			This.pfSettings.pageAdvanced.Label3.Caption = 'LOCAL  =  ' + Proper(Thisform.cCR_StoreLocal)
			This.pfSettings.pageBackups.Label1.Caption  = STRTRAN(This.pfSettings.pageBackups.Label1.Caption,'HOME(7)','<Local>')
			This.pfSettings.pageBackups.Label5.Caption  = 'LOCAL\GoFishBackups\ =  ' + Proper(Thisform.cCR_StoreLocal + 'GoFishBackups\' )
		
		Endif &&thisform.oForm.nFirstLoad=1
		*/SF 20221018 -> local storage
		
		Thisform.Refresh()
		
	ENDPROC

	PROCEDURE KeyPress
		LPARAMETERS nKeyCode, nShiftAltCtrl
		
		If nKeyCOde = 27
			Thisform.Release
		Endif
		
	ENDPROC

	PROCEDURE loadformsettings
		This.MinHeight = This.Height
		This.MinWidth = This.Width
		
		DoDefault()
	ENDPROC

	PROCEDURE loadoptions
		This.oSearchOptions = This.CopyObjectProperties(This.oSearchOptions, CreateObject('GoFishSearchOptions'))
		
		Thisform.LoadResultsFormProperties()
		
		This.BuildColumnCheckBoxes()
	ENDPROC

	PROCEDURE loadresultsformproperties
		Local laProperties[1], lcProperty, lcXmlSettingsFile
		
		lcXmlSettingsFile = Thisform.cUISettingsFile
		
		*-- Get an array of Custom Form-level properties that are on the Restults form.
		*-- Store them in  the corresponding local Form properties here, if present.
		Amembers(laProperties, Thisform.oForm, 0, 'U')
		
		*--- Import Custom properties from oForm to ThisForm
		For x = 1 To Alen(laProperties)
			lcProperty = laProperties[x]
			AddProperty(This, lcProperty)
			Try
					Store Evaluate('Thisform.oForm.' + lcProperty) To ('Thisform.' + lcProperty)
				Catch
			Endtry
		Endfor
		
		Thisform.cUISettingsFile = lcXmlSettingsFile && Must restore, since above trick overwrite this important setting
		
		Thisform.nDockable = Thisform.oForm.Dockable
		
		Thisform.nReplaceRisk = Evl(Thisform.oForm.nReplaceRisk, 1)
		
		*!* ******** JRN Removed 2024-01-05 ********
		*!* *SF 20221015
		*!* * --- set colours used for showing informations ---
		
		*!* *.<<@N>>.BORDERWIDTH = 0
		*!* This.pfSettings.pageColours.Container2.BorderWidth  = 0
		*!* This.pfSettings.pageColours.Container3.BorderWidth  = 0
		*!* This.pfSettings.pageColours.Container4.BorderWidth  = 0
		*!* This.pfSettings.pageColours.Container5.BorderWidth  = 0
		*!* This.pfSettings.pageColours.Container6.BorderWidth  = 0
		*!* This.pfSettings.pageColours.Container7.BorderWidth  = 0
		*!* This.pfSettings.pageColours.Container8.BorderWidth  = 0
		*!* This.pfSettings.pageColours.Container9.BorderWidth  = 0
		*!* This.pfSettings.pageColours.Container10.BorderWidth = 0
		*!* This.pfSettings.pageColours.Container11.BorderWidth = 0
		*!* This.pfSettings.pageColours.Container12.BorderWidth = 0
		*!* This.pfSettings.pageColours.Container13.BorderWidth = 0
		
		*!* This.pfSettings.pageColours.Container1.BorderColor            = Thisform.oForm.nContainerFrameColour
		*!* This.pfSettings.pageColours.Container2.lblExample1.ForeColor  = Thisform.oForm.nFileSCXDynamicForeColour
		*!* This.pfSettings.pageColours.Container3.lblExample1.ForeColor  = Thisform.oForm.nFileVCXDynamicForeColour
		*!* This.pfSettings.pageColours.Container4.lblExample1.ForeColor  = Thisform.oForm.nFilePRGDynamicForeColour
		*!* This.pfSettings.pageColours.Container5.lblExample1.ForeColor  = Thisform.oForm.nFileDefaultDynamicForeColour
		*!* This.pfSettings.pageColours.Container6.BackColor              = Thisform.oForm.nReplacedDynamicBackColour
		*!* This.pfSettings.pageColours.Container7.BackColor              = Thisform.oForm.nRiskExceededDynamicBackColour
		*!* This.pfSettings.pageColours.Container8.BackColor              = Thisform.oForm.nRisk2DynamicBackColour
		*!* This.pfSettings.pageColours.Container9.BackColor              = Thisform.oForm.nRisk3DynamicBackColour
		*!* This.pfSettings.pageColours.Container10.lblExample1.ForeColor = Thisform.oForm.nTreeSearchColour
		*!* This.pfSettings.pageColours.Container11.lblExample1.ForeColor = Thisform.oForm.nTreeUpdateColour
		*!* This.pfSettings.pageColours.Container12.BackColor             = Thisform.oForm.nCSS_tr_even_Colour
		*!* This.pfSettings.pageColours.Container13.BackColor             = Thisform.oForm.nCSS_tr_odd_Colour
		*!* */SF 20221015
		
		*!* *SF 20221017
		*!* Thisform.pfSettings.pageReferences.Enabled                   = Thisform.oForm.nFirstLoad=2
		*!* Thisform.pfSettings.pageAdvanced.chk_CRLocal_Default.Visible = Thisform.oForm.nFirstLoad=2
		*!* Thisform.pfSettings.pageAdvanced.chk_CRLocal.Visible         = Thisform.oForm.nFirstLoad=2
		*!* Thisform.pfSettings.pageAdvanced.cmdSetFolder.Visible        = Thisform.oForm.nFirstLoad=2 And Thisform.oForm.lCR_Local
		*!* Thisform.pfSettings.pageAdvanced.Text1.Visible               = Thisform.oForm.nFirstLoad=2 And Thisform.oForm.lCR_Local
		
		*!* Thisform.pfSettings.pageAdvanced.Label9.Visible = Thisform.oForm.lCR_Store_Restart
		
		
		Thisform.cCR_StoreLocal_Option = Evl(Thisform.oForm.cCR_StoreLocal_Option,;
			Iif(Thisform.oForm.lCR_Local,Thisform.cCR_StoreLocal,''))
		Thisform.cCR_StoreLocal_Set    = Thisform.cCR_StoreLocal_Option
		
		*/SF 20221017
		
	ENDPROC

	PROCEDURE saveoptions
		*-- Transfer Search Engine settings back to Results Form Search Engine instance
		Local laProperties[1]
		
		This.CopyObjectProperties(This.oSearchOptions, Thisform.oSearchEngine.oSearchOptions)
		
		This.ApplyColumnSettings()
		
		*-- Transfer certain settings from Thisform back to the Search Results Form
		With Thisform.oForm
			.Dockable											 = Thisform.nDockable
			.nGridFontSize										 = Thisform.nGridFontSize
			.nTreeViewFontSize									 = Thisform.nTreeViewFontSize
			.nTabsToSpaces										 = Thisform.nTabsToSpaces
			.nDropDownDisplayCount								 = Thisform.nDropDownDisplayCount
			.nDropDownMaxMRU									 = Thisform.nDropDownMaxMRU
			.nReplaceRisk										 = Evl(Thisform.nReplaceRisk, 1)
			.lClearApplyFilter									 = Thisform.lClearApplyFilter
			.lWarnWholeWord										 = Thisform.lWarnWholeWord
			.nBrowserZoom										 = Thisform.nBrowserZoom
		*	.Containerright.Container2.containerWebControl.nZoom = Thisform.nBrowserZoom
			.lRestorePreviousSearchResultsOnStartup				 = Thisform.lRestorePreviousSearchResultsOnStartup
			.lSaveSearchResults									 = Thisform.lSaveSearchResults
		
			.nJanitorSearchHistoryDays	= Thisform.nJanitorSearchHistoryDays
			.nJanitorReplaceHistoryDays	= Thisform.nJanitorReplaceHistoryDays
			.dLastJanitorRunDate		= Thisform.dLastJanitorRunDate
		
			.lCR_Allow            = Thisform.lCR_Allow
			.lCR_Local_Default    = Thisform.lCR_Local_Default
			.lCR_Local            = Thisform.lCR_Local
			.lMoveNewCodeToTopLeft= Thisform.lMoveNewCodeToTopLeft
			.lDesktop             = Thisform.lDesktop
		
			.cCR_StoreLocal_Option = Thisform.cCR_StoreLocal_Option
		Endwith
		
		
		If !Empty(Thisform.cCR_StoreLocal_Option) And !Thisform.cCR_StoreLocal_Option==Thisform.cCR_StoreLocal_Set Then
			Thisform.Set_LocalFolder(Thisform.cCR_StoreLocal_Option)
		Endif &&!EMPTY(Thisform.cCR_StoreLocal_Option) AND Thisform.cCR_StoreLocal_Option=Thisform.cCR_StoreLocal_Set
		
		If Thisform.pfSettings.pageAdvanced.Label9.Visible Then
			Thisform.oForm.lCR_Store_Restart = .T.
			Messagebox('You will have to restart GoFish for this change to take effect.', 0, 'Notice:')
		
		Endif &&Thisform.pfSettings.pageAdvanced.Label9.Visible
		
		
	ENDPROC

	PROCEDURE set_localfolder		&& cCR_StoreLocal_Option activated Check folder
		Lparameters;
			tcFolder
		
		Local;
			lcFolder As String,;
			llFound As Boolean,;
			llSet As Boolean
		
		Do Case
			Case !Empty(m.tcFolder)
		*just store folder given
				lcFolder = m.tcFolder
				llFound  = Create_LocalPath(@lcFolder, .F., .F., .T.)
		
				Put_LocalPath(m.lcFolder)
		
			Case Thisform.oForm.nFirstLoad#2
		*nothing to do
			Case !Thisform.oForm.lCR_Allow
		*nothing to do
			Case !Thisform.oForm.lCR_Local
		*nothing to do
			Case !Empty(Thisform.cCR_StoreLocal_Option)
		*nothing to do, activate
				llSet = .T.
		
			Case Get_LocalPath(@tcFolder) And Directory(m.tcFolder)
		*found resource, activate
				Thisform.cCR_StoreLocal_Option = m.tcFolder
				Thisform.cCR_StoreLocal_Set    = m.tcFolder
				llSet                          = .T.
			Otherwise
		*pick a folder, or use default path
		
				tcFolder = Iif(Thisform.oForm.lCR_Local_Default,'',Justpath(Set("Resource",1)))
				llFound  = Create_LocalPath(@tcFolder, .F., Thisform.oForm.lCR_Local_Default, Thisform.oForm.lCR_Local_Default)
		
				If Directory(m.tcFolder) Then
		*folder found, activate
					Thisform.cCR_StoreLocal_Option = m.tcFolder
					Thisform.cCR_StoreLocal_Set    = m.tcFolder
					Put_LocalPath(m.tcFolder)
					llSet = .T.
				Else  &&Directory(m.tcFolder)
					Thisform.oForm.lCR_Local = .F.
		
				Endif &&Directory(m.tcFolder)
		Endcase
		
		Thisform.pfSettings.pageAdvanced.Text1.Refresh
		
		Return m.llSet
		
	ENDPROC

	PROCEDURE validate
		Local llAtLeastOneColumnSelected, loControl
		
		llAtLeastOneColumnSelected = .f.
		
		For each loControl in thisform.pfSettings.pageColumns.containerColumnCheckBoxes.Controls
			If loControl.value = 1
				llAtLeastOneColumnSelected = .t.
			Endif
		EndFor
		
		If !llAtLeastOneColumnSelected 
			MessageBox('Please select at least one column to display in the grid.', 0, 'Notice:')
			thisform.pfSettings.ActivePage = 1
			Return .f.
		Endif
		
			 
	ENDPROC

	PROCEDURE cmdCancel.Click
		Thisform.lReturn = .f.
		
		thisform.Release()
	ENDPROC

	PROCEDURE cmdOK.Click
		If Thisform.Validate()
			Thisform.lReturn = .t.
			Thisform.Release()
		Endif
		
		
		
		
		
	ENDPROC

	PROCEDURE pfSettings.Page1.Label3.Click
		Shell('https://github.com/VFPX/Thor')
		
	ENDPROC

	PROCEDURE pfSettings.Page1.Label5.Click
		Shell('https://github.com/VFPX/GoFish')
		
	ENDPROC

	PROCEDURE pfSettings.Page2.Spinner1.Valid
		Thisform.dLastJanitorRunDate = {}
	ENDPROC

	PROCEDURE pfSettings.Page2.Spinner2.Valid
		Thisform.dLastJanitorRunDate = {}
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.chk_CRLocal.InteractiveChange
		This.SetFocus
		
		This.Parent.Label9.Visible = .T.
		
		If This.Value Then
			This.Value = Thisform.Set_LocalFolder()
		
		Endif &&This.Value
		
		This.Parent.cmdSetFolder.Visible = Thisform.oForm.nFirstLoad=2 And Thisform.oForm.lCR_Local
		This.Parent.Text1.Visible        = Thisform.oForm.nFirstLoad=2 And Thisform.oForm.lCR_Local
		
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.chk_CRMode.InteractiveChange
		This.SetFocus
		
		This.Parent.Label9.Visible              = .T.
		This.Parent.chk_CRLocal_Default.Visible = This.Value
		This.Parent.chk_CRLocal.Visible         = This.Value
		This.Parent.Text1.Visible               = This.Value
		This.Parent.cmdSetFolder.Visible        = This.Value
		
		If This.Value Then
			Thisform.Set_LocalFolder()
		Endif &&This.Value
		
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.cmdDeleteConfigFiles.Click
		Local lcFilesToDelete, lcPath, lnResponse
		
		*SF 20221018 -> local storage
		*lcPath = '"' + Addbs(Home(7)) + '"'
		lcPath = '"' + Thisform.cCR_StoreLocal + '"'
		*/SF 20221018 -> local storage
		
		lcFilesToDelete = Addbs(lcPath) + 'gf_*.xml'
		
		lnResponse = MessageBox('Are you sure you want to reset GoFish by erasing config files?',3, 'Erase config files?')
		
		If lnResponse = 6
			Delete File (lcFilesToDelete)
		EndIf
		
		This.Parent.list1.Requery()
		
		
		
		
		  
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.cmdOpenFolder.Click
		*SF 20221018 -> local storage
		*lcPath = '"' + Addbs(Home(7)) + '"'
		lcPath = '"' + Thisform.cCR_StoreLocal + '"'
		*/SF 20221018 -> local storage
		
		OpenExplorerWindow(lcPath)
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.cmdSetFolder.Click
		Local;
			lcFolder As String
		
		lcFolder = Thisform.cCR_StoreLocal_Option
		lcFolder = Getdir(m.lcFolder,'Local GoFish config folder. Please pick one.','',64+1+32+2+8)
		If !Empty(m.lcFolder) Then
			Thisform.cCR_StoreLocal_Option = m.lcFolder
			This.Parent.Label9.Visible = .T.
		Endif &&!EMPTY(m.lcFolder)
		
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.List1.Click
		Local lnIndex
		
		lnIndex = this.ListIndex
		lcValue = This.value
		
		If !('.XML' $ Upper(This.value))
			This.Init() && Reset RecordSource
			This.Requery()
		Endif
		
		This.Value = lcValue
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.List1.DblClick
		*SF 20221018 -> local storage
		*lcFile = '"' + Addbs(Home(7)) + this.Value + '"'
		lcFile = '"' + Thisform.cCR_StoreLocal + this.Value + '"'
		*/SF 20221018 -> local storage
		
		If 'GF_' $ Upper(lcFile) and Upper(JustExt(lcFile)) = 'XML'
			Run /n "notepad" &lcFile
		Else
			This.Init() && Reset RecordSource
			This.Requery()
		Endif
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.List1.Init
		*SF 20221018 -> local storage
		*This.RowSource = Addbs(Home(7)) + 'GF_*.xml'
		This.RowSource = Thisform.cCR_StoreLocal + 'GF_*.xml'
		*/SF 20221018 -> local storage
		
	ENDPROC

	PROCEDURE pfSettings.pageAdvanced.Text1.When
		RETURN .F.
	ENDPROC

	PROCEDURE pfSettings.pageBackups.Check1.Click
		DoDefault()
		
		This.Parent.Refresh()
	ENDPROC

	PROCEDURE pfSettings.pageBackups.Command2.Click
		*SF 20221018 -> local storage
		*lcPath = '"' + Addbs(Home(7) + 'GoFishBackups') + '"'
		lcPath = '"' + Addbs(Thisform.cCR_StoreLocal + 'GoFishBackups') + '"'
		*/SF 20221018 -> local storage
		
		OpenExplorerWindow(lcPath)
		
	ENDPROC

	PROCEDURE pfSettings.pageBackups.Label2.Click
		messagebox('No help available at this time.', 0, 'GoFish')
		*** TODO: Shell('URL for backup help')
		
	ENDPROC

	PROCEDURE pfSettings.pageColumns.cmdClearAll.Click
		For each loControl in this.Parent.containerColumnCheckBoxes.Controls
			loControl.value = 0
		EndFor
		
	ENDPROC

	PROCEDURE pfSettings.pageColumns.cmdSelectAll.Click
		For each loControl in this.Parent.containerColumnCheckBoxes.Controls
			loControl.value = 1
		EndFor
		
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.Activate
		This.Refresh()
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.cboDockable.InteractiveChange
		lnCurrentDockable = Thisform.oForm.Dockable
		lnNewValue = this.Value
		
		If lnNewValue = 0 and lnCurrentDockable # 0
			MessageBox('You will have to restart GoFish for this change to take effect.', 0, 'Notice:')
		Endif
		
		Thisform.nDockable = This.Value
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.chkDesktop.InteractiveChange
		local loMy, ;
			loSettings, ;
			lcSettingsFile
		loMy = newobject('My', 'My.vcx')
		loSettings = loMy.Settings
		
		*SF 20221018 -> local storage
		*lcSettingsFile = addbs(home(7)) + Thisform.oForm.cUISettingsFile
		lcSettingsFile = Thisform.cCR_StoreLocal + Thisform.oForm.cUISettingsFile
		*/SF 20221018 -> local storage
		
		m.loSettings.Load(m.lcSettingsFile)
		m.loSettings.Add('lDesktop', This.Value)
		m.loSettings.Save(m.lcSettingsFile)
		messagebox('Note: this change takes effect the next time you run GoFish.', 64, 'GoFish')
		
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.cmdZoomDefault.Click
		Thisform.nBrowserZoom = 1.0
		This.Parent.Refresh()
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.Command1.Click
		Local lcFolder, lcPath
		
		lcFolder = "GF_Saved_Search_Results"
		
		*SF 20221018 -> local storage
		*lcPath = '"' + Addbs(Home(7)) + lcFolder  + '"'
		lcPath = '"' + Thisform.cCR_StoreLocal + lcFolder  + '"'
		*/SF 20221018 -> local storage
		
		OpenExplorerWindow(lcPath) 
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.Spinner4.Click
		Nodefault
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.Spinner4.DownClick
		This.Value = This.Value - 0.00
		
		Nodefault
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.Spinner4.UpClick
		This.Value = This.Value + 0.00
		
		nodefault
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.Spinner4.Valid
		If This.Value < This.SpinnerLowValue
			This.Value = This.SpinnerLowValue
		EndIf
		
		If This.Value > This.SpinnerHighValue
			This.Value = This.SpinnerHighValue
		Endif
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.Text1.Click
		This.SelStart = 0
		This.SelLength = 100
	ENDPROC

	PROCEDURE pfSettings.pagePreferences.Text1.Valid
		If this.Value <= 0
			MessageBox('Please enter a value greater than zero.', 64, 'GoFish')
			Return .f.
		Endif
		
			
	ENDPROC

	PROCEDURE pfSettings.pageReplace.Activate
		This.Refresh()
	ENDPROC

	PROCEDURE pfSettings.pageReplace.Check1.Click
		DoDefault()
		
		Thisform.oSearchOptions.lBackup = .t.
		
		This.Parent.Refresh()
	ENDPROC

	PROCEDURE pfSettings.pageReplace.Check2.Click
		DoDefault()
		
		This.Parent.Refresh()
	ENDPROC

	PROCEDURE pfSettings.pageReplace.cmdOpenFolder.Click
		Local lcPath
		
		lcPath = JustPath(Thisform.oSearchEngine.cReplaceDetailTable)
		
		OpenExplorerWindow(lcPath) 
	ENDPROC

	PROCEDURE pfSettings.pageReplace.Label2.Click
		messagebox('No help available at this time.', 0, 'GoFish')
		*** TODO: Shell('URL for replace help')
		
	ENDPROC

	PROCEDURE pfSettings.pageReplace.optiongroupReplaceSafetyLevel.Option2.Click
		DoDefault()
		
		This.Parent.Refresh()
		
		
	ENDPROC

	PROCEDURE pfSettings.pageReplace.optiongroupReplaceSafetyLevel.Option3.Click
		DoDefault()
		
		This.Parent.Refresh()
		
		
	ENDPROC

	PROCEDURE pfSettings.pageReplace.optiongroupReplaceSafetyLevel.Option4.Click
		DoDefault()
		
		This.Parent.Refresh()
		
	ENDPROC

	PROCEDURE pfSettings.pageReplace.optiongroupReplaceSafetyLevel.Refresh
		lnColor = Rgb(240, 240, 240)
		
		lnRiskLevel = This.Value
		
		Do Case
		Case lnRiskLevel  = 1 
			lnColor = Rgb(0, 176, 80)&& Green
		
		Case lnRiskLevel  = 2
			lnColor = Rgb(255, 255, 128) && Yellow
		
		Case lnRiskLevel = 3
			lnColor = Rgb(255, 192, 0)&& Orange
		Endcase
		
		If Thisform.oSearchOptions.lEnableReplaceMode = .t.
			This.BackColor = lnColor
			This.SetAll('Enabled', .t., 'OptionButton')
			This.SetAll('Forecolor', Rgb(0,0,0), 'OptionButton')
		Else
			This.BackColor = Rgb(255,255,255)
			This.SetAll('Enabled', .f., 'OptionButton')
			This.SetAll('DisabledForecolor', Rgb(210,210,210), 'OptionButton')
		Endif
		
		
		DoDefault()
		
	ENDPROC

	PROCEDURE pfSettings.pageReplace.Refresh
		this.Parent.pageBackups.Enabled = Thisform.oSearchOptions.lEnableReplaceMode
		
		DoDefault()
	ENDPROC

	PROCEDURE pfSettings.pageReplace.Text1.Valid
		If this.Value <= 0
			MessageBox('Please enter a value greater than zero.', 64, 'GoFish')
			Return .f.
		Endif
		
			
	ENDPROC

	PROCEDURE pfSettings.pageReplace.Text2.Valid
		If this.Value <= 0
			MessageBox('Please enter a value greater than zero.', 64, 'GoFish')
			Return .f.
		Endif
		
			
	ENDPROC

	PROCEDURE pfSettings.pageThor.Activate
		Local llThorRunning
		
		Try
		    ExecScript(_Screen.cThorDispatcher, '?')
		    llThorRunning = .T.
		Catch
		    llThorRunning = .F.
		EndTry
		
		This.lblNoThor.Visible = !llThorRunning
		
	ENDPROC

	PROCEDURE pfSettings.pageThor.Label2.Click
		Shell('https://github.com/VFPX/Thor')
		
	ENDPROC

ENDDEFINE
